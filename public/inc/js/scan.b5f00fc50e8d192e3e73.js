!function(e){function t(a){if(n[a])return n[a].exports;var o=n[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/inc/",t(t.s="cdgC")}({"3tUr":function(e,t){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};document.app.Scan={init:function(){var e=this;this.initElements(),this.attachListeners(),0!==this.objControlsForm.length&&(this.objNotfound.hide(),this.objToHideWhenOff.show(),Quagga.init(this.defaultValues,function(t){if(t)return e.handleError(t);e.initCameraSelection(),document.app.Scan.checkCapabilities(),Quagga.start()}),Quagga.onProcessed(function(e){var t=Quagga.canvas.ctx.overlay,n=Quagga.canvas.dom.overlay;e&&(e.boxes&&(t.clearRect(0,0,parseInt(n.getAttribute("width")),parseInt(n.getAttribute("height"))),e.boxes.filter(function(t){return t!==e.box}).forEach(function(e){Quagga.ImageDebug.drawPath(e,{x:0,y:1},t,{color:"green",lineWidth:2})})),e.box&&Quagga.ImageDebug.drawPath(e.box,{x:0,y:1},t,{color:"#00F",lineWidth:2}),e.codeResult&&e.codeResult.code&&Quagga.ImageDebug.drawPath(e.line,{x:"x",y:"y"},t,{color:"red",lineWidth:3}))}),Quagga.onDetected(function(e){document.app.Util.doAjax(document.app.url.barcode,{barcode:e.codeResult.code},document.app.Scan.displayResult)}))},defaultValues:{inputStream:{type:"LiveStream",constraints:{width:{min:parseInt(document.querySelector('select[name="input-stream_constraints"]')?document.querySelector('select[name="input-stream_constraints"]').value.split("x")[0]:0)},height:{min:parseInt(document.querySelector('select[name="input-stream_constraints"]')?document.querySelector('select[name="input-stream_constraints"]').value.split("x")[1]:0)},facingMode:"environment",aspectRatio:{min:1,max:2}}},numOfWorkers:0,frequency:10,decoder:{readers:[{format:"ean_reader",config:{}}]},locate:!0},initElements:function(){console.log("TODO : If cannot torch hide button"),this.objControlsForm=$(".controls FORM"),this.objToHideWhenOff=$(".toHideWhenOff"),this.objNotfound=$("#notfound"),this.objCameraTorch=$("#cameraTorch"),this.objControls=$(".controls .reader-config-group")},attachListeners:function(){var e=this;this.objCameraTorch.on("click",function(t){t.preventDefault();var n=$(this);e.applySetting("torch",n.hasClass("off")),n.toggleClass("off")}),this.objControls.on("change","input, select",function(t){t.preventDefault();var n=$(t.target),a="checkbox"===n.attr("type")?n.prop("checked"):n.val(),o=n.attr("name"),i=e._convertNameToState(o);e.setState(i,a)})},closeScan:function(){Quagga.stop(),this.objToHideWhenOff.hide(),this.objControlsForm[0].reset(),document.app.Scan.detachListeners()},handleError:function(e){console.log(e)},checkCapabilities:function(){var e=Quagga.CameraAccess.getActiveTrack(),t={};"function"==typeof e.getCapabilities&&(t=e.getCapabilities()),this.applySettingsVisibility("zoom",t.zoom),this.applySettingsVisibility("torch",t.torch)},updateOptionsForMediaRange:function(e,t){console.log("updateOptionsForMediaRange",e,t);for(var n,a,o=(t.max-t.min)/6;e.firstChild;)e.removeChild(e.firstChild);for(var i=0;i<=6;i++)a=t.min+o*i,n=document.createElement("option"),n.value=a,n.innerHTML=a,e.appendChild(n)},applySettingsVisibility:function(e,t){var n=document.querySelector('input[name="settings_'+e+'"]'),a=document.querySelector("button."+e);if("boolean"==typeof t)return n&&(n.parentNode.style.display=t?"block":"none"),void(a&&(a.style.display=t?"block":"none"));window.MediaSettingsRange&&t instanceof window.MediaSettingsRange&&(n&&(this.updateOptionsForMediaRange(n,t),n.parentNode.style.display="block"),a&&(a.style.display="block"))},initCameraSelection:function(){var e=Quagga.CameraAccess.getActiveStreamLabel();return Quagga.CameraAccess.enumerateVideoDevices().then(function(t){function n(e){return e.length>30?e.substr(0,30):e}for(var a=document.getElementById("deviceSelection");a.firstChild;)a.removeChild(a.firstChild);t.forEach(function(t){var o=document.createElement("option");o.value=t.deviceId||t.id,o.appendChild(document.createTextNode(n(t.label||t.deviceId||t.id))),o.selected=e===t.label&&"selected",a.appendChild(o)}),M.FormSelect.init(document.querySelector("#deviceSelection"))})},_accessByPath:function(e,t,a){var o=t.split("."),i=o.length,r=void 0!==a;return o.reduce(function(e,t,o){return r&&o+1===i&&("object"===n(e[t])&&"object"===(void 0===a?"undefined":n(a))?Object.assign(e[t],a):e[t]=a),t in e?e[t]:{}},e)},_convertNameToState:function(e){return e.replace("_",".").split("-").reduce(function(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)})},detachListeners:function(){this.objControls.off("change"),this.objCameraTorch.off("click")},applySetting:function(e,t){var n=Quagga.CameraAccess.getActiveTrack();if(n&&"function"==typeof n.getCapabilities)switch(e){case"zoom":return n.applyConstraints({advanced:[{zoom:parseFloat(t)}]});case"torch":return n.applyConstraints({advanced:[{torch:!!t}]})}},setState:function(e,t){var n=this;if("function"==typeof n._accessByPath(n.inputMapper,e)&&(t=n._accessByPath(n.inputMapper,e)(t)),e.startsWith("settings.")){var a=e.substring(9);return n.applySetting(a,t)}n._accessByPath(n.state,e,t),document.app.Scan.detachListeners(),Quagga.stop(),document.app.Scan.init()},inputMapper:{inputStream:{constraints:function(e){if(/^(\d+)x(\d+)$/.test(e)){var t=e.split("x");return{width:{min:parseInt(t[0])},height:{min:parseInt(t[1])}}}return{deviceId:e}}},numOfWorkers:function(e){return parseInt(e)},decoder:{readers:function(e){return"ean_extended"===e?[{format:"ean_reader",config:{supplements:["ean_5_reader","ean_2_reader"]}}]:[{format:e+"_reader",config:{}}]}}},state:this.defaultValues,displayResult:function(e){$("#barcode").val(e.barcode),e.name?e.remove?document.location=document.app.url.displayResult:document.location=document.app.url.displayProduct+"/"+e.barcode+"/stock_add":(document.app.Scan.closeScan(),$("#notfoundbarcode").html(e.barcode),$("#notfound").show())}},$(document).ready(function(){document.app.Scan.init()})},JW6i:function(e,t){!function(){"use strict";function e(e){return e.charAt(0).toUpperCase()+e.slice(1)}if("webkitSpeechRecognition"in window){var t=document.getElementsByClassName("speech-input");[].forEach.call(t,function(t){function n(){m=setTimeout(function(){v.stop()},1e3*c)}var a,o,i,r,c=parseInt(t.dataset.patience,10)||6,s=t.nextSibling,l=t.parentNode,u=parseInt(getComputedStyle(t).borderRightWidth,10),d=.8*(t.dataset.buttonsize||t.offsetHeight);!t.dataset.buttonsize&&"TEXTAREA"===t.tagName&&d>26&&(d=26);var p=t.parentNode;p.classList.contains("si-wrapper")||(p=document.createElement("div"),p.classList.add("si-wrapper"),p.appendChild(l.removeChild(t)),r=!0),a=p.querySelector(".si-btn"),a||(a=document.createElement("button"),a.type="button",a.classList.add("si-btn"),a.textContent="speech input",o=document.createElement("span"),i=document.createElement("span"),o.classList.add("si-mic"),i.classList.add("si-holder"),a.appendChild(o),a.appendChild(i),p.appendChild(a),a.style.cursor="pointer",a.style.top=.125*d+"px",a.style.height=a.style.width=d+"px",t.style.paddingRight=d-u+"px"),r&&l.insertBefore(p,s);var f,m,h="",g=!1,b=null,v=new webkitSpeechRecognition;v.continuous=!0,v.interimResults=!0,t.lang&&(v.lang=t.lang),v.onstart=function(){b=t.placeholder,t.placeholder=t.dataset.ready||"Speak now",g=!0,a.classList.add("listening"),n()},v.onend=function(){g=!1,clearTimeout(m),a.classList.remove("listening"),null!==b&&(t.placeholder=b),void 0!==t.dataset.instantSubmit&&t.value&&t.form&&t.form.submit()},v.onresult=function(a){clearTimeout(m);for(var o=a.results,i="",r="",c=a.resultIndex;c<o.length;++c){var s=o[c],l=s[0];s.isFinal?i=l.transcript:r+=l.transcript}var u=i||r;u=!h||f?e(u):u,t.value=h+u,t.focus(),"INPUT"===t.tagName?t.scrollLeft=t.scrollWidth:t.scrollTop=t.scrollHeight,n()},a.addEventListener("click",function(e){if(e.preventDefault(),g)return void v.stop();var n=t.value.slice(-1).match(/\s/);h=!t.value||n?t.value:t.value+" ",f=h.trim().slice(-1).match(/[\.\?\!]/),v.start()},!1)})}}()},cdgC:function(e,t,n){n("3tUr"),n("JW6i")}});